<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>PrimoBurner(tm) for C++: Object Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra-doxygen.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-226295-13']);
    _gaq.push(['_trackPageview']);
    (function () {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PrimoBurner(tm) for C++
   &#160;<span id="projectnumber">4.3</span>
   </div>
   <div id="projectbrief">CD, DVD and Blu-ray Software Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_object_management.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Object Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="main_sec"></a>
Common Rules for Object Management in PrimoBurner (C++)</h1>
<p>Memory management is fundamental to using PrimoBurner effectively and efficiently. This topic is essential reading for all developers who use PrimoBurner. For managing memory PrimoBurner uses a reference-counting mechanism, and a policy of object ownership that is suggested by the names of interfaces and methods.</p>
<p>Ownership Policy</p>
<p>When trying to understand memory management in a PrimoBurner application, it is helpful to think not in terms of memory management per se, but instead in terms of object ownership. An object may have one or more owners; it records the number of owners it has using a reference count. If an object has no owners (if its reference count drops to zero), it is disposed of (freed). PrimoBurner defines the following rules for object ownership and disposal.</p>
<p>There are two distinct types of objects in PrimoBurner: </p>
<ol>
<li>
Objects with reference management. They implement the <a class="el" href="classprimo_1_1_reference.html" title="Base class for all objects that require reference management. ">primo::Reference</a> interface. Most objects fall into this category. </li>
<li>
Objects without reference management. They do not inherit from <a class="el" href="classprimo_1_1_reference.html" title="Base class for all objects that require reference management. ">primo::Reference</a>. </li>
</ol>
<h1><a class="anchor" id="obj_ref_count"></a>
1. Objects with reference management.</h1>
<p>These objects keep an internal reference count which is controlled via the <a class="el" href="classprimo_1_1_reference.html" title="Base class for all objects that require reference management. ">primo::Reference</a> interface. The count is increased via <a class="el" href="classprimo_1_1_reference.html#a32bf3bb7985194840714fbc6d737edee">Reference::retain</a> and decreased via <a class="el" href="classprimo_1_1_reference.html#a8de62834069c405b6e91b432383868b9">Reference::release</a>. By convention when an object with a reference count of 1 is released it is destroyed. As part of the destruction process the object releases all other objects that it has retained itself.</p>
<h2><a class="anchor" id="obj_create"></a>
Creating Objects</h2>
<p>A PrimoBurner object is created through one of the following verbs: <em><b>create</b></em>, <em><b>clone</b></em>, <em><b>copy</b></em> and <em><b>read</b></em>. </p>
<ol>
<li>
Creating functions that begin with the word <em><b>create</b></em> in the C++ API (for example <a class="el" href="namespaceprimo_1_1burner_1_1_library.html#a2d8243b5fb273102d35b10595f1223eb">Library::createDataDisc</a> and <a class="el" href="classprimo_1_1burner_1_1_device_enum.html#a6ae145af0f654fd41272b057703f0b0e">DeviceEnum::createDevice</a>). The library creating functions have equivalent C exported functions beginning with <em><b>pb_create</b></em> (for example pb_create_data_disc).  </li>
<li>
Cloning functions like <a class="el" href="classprimo_1_1burner_1_1_error_info.html#a96cec1fcd0689399b86e700f0ab10772">ErrorInfo::clone</a>, <a class="el" href="classprimo_1_1burner_1_1_audio_input.html#a0962ed1d8af5722ac3e3f852b4b8c98b">AudioInput::clone</a> and <a class="el" href="classprimo_1_1burner_1_1_audio_output.html#ab27d908df2fbe053c41979bd8f783f8c">AudioOutput::clone</a>.  </li>
<li>
Copy functions like <a class="el" href="classprimo_1_1burner_1_1_data_disc.html#a19a51b3a75dc08f8594b1d0fefe98257">DataDisc::copyImageLayout</a> and <a class="el" href="classprimo_1_1burner_1_1_video_d_v_d.html#a19a51b3a75dc08f8594b1d0fefe98257">VideoDVD::copyImageLayout</a>.  </li>
<li>
Device read functions like <a class="el" href="classprimo_1_1burner_1_1_device.html#a186f6d817d3a57b59f3cf4d49580d236">Device::readCDText</a>, <a class="el" href="classprimo_1_1burner_1_1_device.html#a05612ff3d1d1c6c84100a84c2d009782">Device::readDiscInfo</a>, <a class="el" href="classprimo_1_1burner_1_1_device.html#a199d613523d0bcc0b0134e3512a1aa73">Device::readToc</a>, etc. The information read by the device is returned through a new object instance and the ownership is transferred to the user code.  </li>
</ol>
<p>An object that is created by one of the methods described above is reference counted. Its initial reference count is 1. The user code is responsible for managing such an object and it should be released when it is not needed anymore.</p>
<h2><a class="anchor" id="obj_as_parameter"></a>
Passing Objects as Function Parameters</h2>
<p>When an object is passed as a parameter to a PrimoBurner function it may or may not be retained by the function. This depends on how the parameter is used in the Library and this is stated clearly in the documentation. The basic principle is that when the object will be used by PrimoBurner after the function returns then it is retained by the Library (for example when a <a class="el" href="classprimo_1_1burner_1_1_c_d_track.html">CDTrack</a> object is passed to <a class="el" href="classprimo_1_1burner_1_1_c_d_track_list.html#a511c85e9da8e1f38de9c00b66b62fd99">CDTrackList::add</a> it is retained since it becomes part of the list). If the passed object is used only within the function then it is not retained (for example when a <a class="el" href="classprimo_1_1burner_1_1_audio_output.html">AudioOutput</a> object is passed to <a class="el" href="classprimo_1_1burner_1_1_audio_c_d.html#a28f3810b6e32646bebe68fa5baf95f3f">AudioCD::readTrackFromCD</a> it is not retained because it is used only within this method).</p>
<h3><a class="anchor" id="obj_as_return_value"></a>
Returning Objects from Functions</h3>
<p>A reference counted object can be returned either as a result of a creating (clone/copy/read) operation (see <a class="el" href="_object_management.html#obj_create">Creating Objects</a> above) or because the object already exists and it is being accessed. As already mentioned when a new object is created the user code is responsible to release it when it's not needed anymore. But when a reference counted object is simply accessed the user code should not release it. It should do so only if it has previously retained the object. This is an option that can be used when the returned object must be detached from the container (for example the client code may want to keep a <a class="el" href="classprimo_1_1burner_1_1_c_d_track.html">CDTrack</a> object returned by <a class="el" href="classprimo_1_1burner_1_1_c_d_track_list.html#a3d39d296e1e006506b7251e61efa7a7a">CDTrackList::at</a> even when the <a class="el" href="classprimo_1_1burner_1_1_c_d_track_list.html">CDTrackList</a> that holds it is destroyed).</p>
<h1><a class="anchor" id="obj_no_ref_count"></a>
2. Objects without reference management.</h1>
<p>The objects that fall in this category cannot be created separately by the user code. They exist only in the context of another PrimoBurner object and cannot be detached from it. Their lifetime depends only on the object that holds them. Objects without reference management do not inherit from <a class="el" href="classprimo_1_1_reference.html" title="Base class for all objects that require reference management. ">primo::Reference</a>.</p>
<p>Examples of such objects are:<br/>
 <a class="el" href="classprimo_1_1burner_1_1_audio_input_list.html">AudioInputList</a> returned by <a class="el" href="classprimo_1_1burner_1_1_audio_c_d.html#a08891acaf55bc9d538536133b8e9dfd0">AudioCD::audioInputs</a>,<br/>
 <a class="el" href="classprimo_1_1burner_1_1_udf_volume_props.html">UdfVolumeProps</a> returned by <a class="el" href="classprimo_1_1burner_1_1_data_disc.html#aff504c303d3bb34074759a0033cc18c7">DataDisc::udfVolumeProps</a>,<br/>
 <a class="el" href="classprimo_1_1burner_1_1_boot_props.html">BootProps</a> returned by <a class="el" href="classprimo_1_1burner_1_1_data_disc.html#ac74c0a582d8b11c351d8ae22d6ebbdb7">DataDisc::bootProps</a>, etc. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
    <a href="http://primosoftware.com" target="_blank">(c) 2014 Primo Software Corporation. All rights reserved.</a>
    </li>
  </ul>
</div>
</body>
</html>
